import "tfplan"

has_valid_tags = func(resource) {
  print(resource)
  print(resource.applied.tags)
  validated = true
  if resource.applied.tags is not undefined {
    validated = resource.applied.tags contains "environment"
  }
  return validated
}

main = rule {
  all tfplan.resources as _, resource {
    has_valid_tags(resource)
  }
}