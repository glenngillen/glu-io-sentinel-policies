import "tfplan"

has_valid_tags = func(resource) {
  validated = true
  print(resource)
  print(resource.applied)
  print(resource.applied.tags)
  return validated
}

main = rule {
  all tfplan.resources as _, types {
    all types as _, type {
      all type as _, resource {
        has_valid_tags(resource)
      }
    }
  }
}